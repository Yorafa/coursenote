"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[7967],{7393:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>o});var r=n(5893),t=n(1151);const l={},a="Thread",i={id:"csc/csc369/03 thread",title:"Thread",description:"Processes have private virtual address space and are isolated from each other. But can be communicated to each other by signals, pipes, sockets, files, etc. Processes also can share their memory by system call like shmget(), shmat(), mmap(), etc.",source:"@site/docs/csc/csc369/03 thread.md",sourceDirName:"csc/csc369",slug:"/csc/csc369/03 thread",permalink:"/docs/csc/csc369/03 thread",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"System Call",permalink:"/docs/csc/csc369/02 system call"},next:{title:"Synchronization",permalink:"/docs/csc/csc369/04 Synchronization"}},c={},o=[{value:"Kernel-level threads",id:"kernel-level-threads",level:2},{value:"User-level threads",id:"user-level-threads",level:2}];function d(e){const s={code:"code",h1:"h1",h2:"h2",li:"li",p:"p",ul:"ul",...(0,t.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.h1,{id:"thread",children:"Thread"}),"\n",(0,r.jsxs)(s.p,{children:["Processes have private virtual address space and are isolated from each other. But can be communicated to each other by signals, pipes, sockets, files, etc. Processes also can share their memory by system call like ",(0,r.jsx)(s.code,{children:"shmget()"}),", ",(0,r.jsx)(s.code,{children:"shmat()"}),", ",(0,r.jsx)(s.code,{children:"mmap()"}),", etc."]}),"\n",(0,r.jsxs)(s.p,{children:["In CSC209, we wrote a web server. To execture it, we used ",(0,r.jsx)(s.code,{children:"fork()"}),", we need to:"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"create several processes that execute in parallel"}),"\n",(0,r.jsx)(s.li,{children:"cause each to map to the same address space to share data"}),"\n",(0,r.jsx)(s.li,{children:"have the OS schedule these processes in parallel"}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"But it is inefficient:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Space: taks struct, page tables, etc all duplicated since fork creates a new process"}),"\n",(0,r.jsx)(s.li,{children:"Time: need to create data structures, fork and copy address space, etc"}),"\n",(0,r.jsx)(s.li,{children:"Inter-process communication (IPC): extra work is needed to share and communicate across isolated processes"}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"That is, we can use thread to resolve it, where:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"thread can solve a single problem concurrently and can easily share code, heap, and global variables"}),"\n",(0,r.jsx)(s.li,{children:"fater to create and destory"}),"\n",(0,r.jsx)(s.li,{children:"potentially faster context switch times"}),"\n",(0,r.jsx)(s.li,{children:"overlapping computation and I/O"}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Thread: a single control flow (Sequence of instructions in execution) through a program. A program with multiple control flows is multithreaded. (OS is multithreaded since it must interact with multiple running programs)."}),"\n",(0,r.jsx)(s.h2,{id:"kernel-level-threads",children:"Kernel-level threads"}),"\n",(0,r.jsx)(s.p,{children:"Something about Kernel-lvl threads:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"all thread operations are implemented in the kernel"}),"\n",(0,r.jsx)(s.li,{children:"OS schedules all of the threads in the system"}),"\n",(0,r.jsx)(s.li,{children:"also be called light-weight processes (LWP)"}),"\n",(0,r.jsx)(s.li,{children:"differ than kernel thread where kernel thread runs entirely inside the kernel"}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Limitations of kernel-level threads:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"thread operations still require system calls"}),"\n",(0,r.jsx)(s.li,{children:"have to general to support the needs of all programmers, languages and runtimes"}),"\n",(0,r.jsx)(s.li,{children:"no control over scheduling of threads"}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"user-level-threads",children:"User-level threads"}),"\n",(0,r.jsx)(s.p,{children:"To make threads cheap and fast, they need to be implemented at user-level:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"user-lvl threads are managed entirely by the runtime system"}),"\n",(0,r.jsx)(s.li,{children:"represented by a PC, registers, stack and small thread control block"}),"\n",(0,r.jsx)(s.li,{children:"creating a new thread, switching between them, and synchronization are done via procedure calls (i.e. no more kernel involvement)"}),"\n",(0,r.jsx)(s.li,{children:"User-level thread operations are up to 100x faster than kernel-level threads (given by csc369 ppt)"}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Limitations of user-level threads:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"invisible to the OS"}),"\n",(0,r.jsx)(s.li,{children:"OS can make poor decisions (i.e. scheduling a process with idle threads)"}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,t.a)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},1151:(e,s,n)=>{n.d(s,{Z:()=>i,a:()=>a});var r=n(7294);const t={},l=r.createContext(t);function a(e){const s=r.useContext(l);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),r.createElement(l.Provider,{value:s},e.children)}}}]);